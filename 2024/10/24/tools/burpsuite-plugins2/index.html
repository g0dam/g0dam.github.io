<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Custom Scan Checks Example ExtensionThe sample extension demonstrates the following techniques:  Registering a custom scan check Performing passive and active scanning when initiated by the user Using">
<meta property="og:type" content="article">
<meta property="og:title" content="【工具开发】Burpsuite 插件开发 2">
<meta property="og:url" content="https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/index.html">
<meta property="og:site_name" content="g0dam">
<meta property="og:description" content="Custom Scan Checks Example ExtensionThe sample extension demonstrates the following techniques:  Registering a custom scan check Performing passive and active scanning when initiated by the user Using">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/image.png">
<meta property="article:published_time" content="2024-10-24T02:41:49.000Z">
<meta property="article:modified_time" content="2024-10-24T08:37:21.298Z">
<meta property="article:author" content="g0dam">
<meta property="article:tag" content="burpsuite">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/image.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>【工具开发】Burpsuite 插件开发 2</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/true" title="g0dam" type="application/atom+xml" />
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/categories/">Categories</a></li><!--
     --><!--
       --><li><a href="/idea/">Idea</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/g0dam">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2024/10/24/tools/aiassist/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2024/10/23/tools/burpsuite-plugins/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&text=【工具开发】Burpsuite 插件开发 2"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&title=【工具开发】Burpsuite 插件开发 2"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&is_video=false&description=【工具开发】Burpsuite 插件开发 2"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=【工具开发】Burpsuite 插件开发 2&body=Check out this article: https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&title=【工具开发】Burpsuite 插件开发 2"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&title=【工具开发】Burpsuite 插件开发 2"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&title=【工具开发】Burpsuite 插件开发 2"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&title=【工具开发】Burpsuite 插件开发 2"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&name=【工具开发】Burpsuite 插件开发 2&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&t=【工具开发】Burpsuite 插件开发 2"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Custom-Scan-Checks-Example-Extension"><span class="toc-number">1.</span> <span class="toc-text">Custom Scan Checks Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Custom-Session-Tokens-Example-Extension"><span class="toc-number">2.</span> <span class="toc-text">Custom Session Tokens Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Custom-Intruder-Payloads-Example-Extension"><span class="toc-number">3.</span> <span class="toc-text">Custom Intruder Payloads Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Persistence-Example-Extension"><span class="toc-number">4.</span> <span class="toc-text">Persistence Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WebSocket-Handler-Example-Extension"><span class="toc-number">5.</span> <span class="toc-text">WebSocket Handler Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Menu-Bar-Example-Extension"><span class="toc-number">6.</span> <span class="toc-text">Menu Bar Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Context-Menu-Example-Extension"><span class="toc-number">7.</span> <span class="toc-text">Context Menu Example Extension</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        【工具开发】Burpsuite 插件开发 2
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">g0dam</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-10-24T02:41:49.000Z" class="dt-published" itemprop="datePublished">2024-10-24</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/Tools/">Tools</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/burpsuite/" rel="tag">burpsuite</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Custom-Scan-Checks-Example-Extension"><a href="#Custom-Scan-Checks-Example-Extension" class="headerlink" title="Custom Scan Checks Example Extension"></a>Custom Scan Checks Example Extension</h2><p>The sample extension demonstrates the following techniques:</p>
<ul>
<li>Registering a custom scan check</li>
<li>Performing passive and active scanning when initiated by the user</li>
<li>Using the Burp-provided <code>AuditInsertionPoint</code> to construct requests for active scanning using specified payloads</li>
<li>Using a helper method to search responses for relevant match strings</li>
<li>Providing an <code>MarkedHttpRequestResponse</code> to highlight relevant portions of requests and responses, </li>
<li>Synchronously reporting custom scan issues in response to the relevant checks.</li>
<li>Guiding Burp on when to consolidate duplicated issues at the same URL (e.g., when the user has scanned the same item multiple times).</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.core.Marker;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.HttpRequestResponse;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.requests.HttpRequest;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.scanner.AuditResult;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.scanner.ConsolidationAction;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.scanner.ScanCheck;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.scanner.audit.insertionpoint.AuditInsertionPoint;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.scanner.audit.issues.AuditIssue;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.scanner.audit.issues.AuditIssueConfidence;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.scanner.audit.issues.AuditIssueSeverity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.core.ByteArray.byteArray;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.scanner.AuditResult.auditResult;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.scanner.ConsolidationAction.KEEP_BOTH;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.scanner.ConsolidationAction.KEEP_EXISTING;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.scanner.audit.issues.AuditIssue.auditIssue;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.util.Collections.emptyList;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.util.Collections.singletonList;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现 ScanCheck 接口的 MyScanCheck 类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyScanCheck</span> <span class="keyword">implements</span> <span class="title class_">ScanCheck</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">GREP_STRING</span> <span class="operator">=</span> <span class="string">&quot;Page generated by:&quot;</span>; <span class="comment">// 用于被动扫描的字符串</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">INJ_TEST</span> <span class="operator">=</span> <span class="string">&quot;|&quot;</span>; <span class="comment">// 用于主动扫描的测试注入字符串</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">INJ_ERROR</span> <span class="operator">=</span> <span class="string">&quot;Unexpected pipe&quot;</span>; <span class="comment">// 期望在响应中发现的错误信息</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MontoyaApi api; <span class="comment">// MontoyaApi 实例，用于访问 API 功能</span></span><br><span class="line"></span><br><span class="line">    MyScanCheck(MontoyaApi api)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.api = api;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 主动扫描方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> AuditResult <span class="title function_">activeAudit</span><span class="params">(HttpRequestResponse baseRequestResponse, AuditInsertionPoint auditInsertionPoint)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 构建包含测试负载的 HTTP 请求</span></span><br><span class="line">        <span class="type">HttpRequest</span> <span class="variable">checkRequest</span> <span class="operator">=</span> auditInsertionPoint.buildHttpRequestWithPayload(byteArray(INJ_TEST)).withService(baseRequestResponse.httpService());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 发送请求并获取响应</span></span><br><span class="line">        <span class="type">HttpRequestResponse</span> <span class="variable">checkRequestResponse</span> <span class="operator">=</span> api.http().sendRequest(checkRequest);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取响应中的特定错误信息的高亮显示</span></span><br><span class="line">        List&lt;Marker&gt; responseHighlights = getResponseHighlights(checkRequestResponse, INJ_ERROR);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 根据响应中是否包含期望的错误信息来创建审计问题</span></span><br><span class="line">        List&lt;AuditIssue&gt; auditIssueList = responseHighlights.isEmpty() ? emptyList() : singletonList(</span><br><span class="line">                auditIssue(</span><br><span class="line">                        <span class="string">&quot;Pipe injection&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;Submitting a pipe character returned the string: &quot;</span> + INJ_ERROR,</span><br><span class="line">                        <span class="literal">null</span>,</span><br><span class="line">                        baseRequestResponse.request().url(),</span><br><span class="line">                        AuditIssueSeverity.HIGH,</span><br><span class="line">                        AuditIssueConfidence.CERTAIN,</span><br><span class="line">                        <span class="literal">null</span>,</span><br><span class="line">                        <span class="literal">null</span>,</span><br><span class="line">                        AuditIssueSeverity.HIGH,</span><br><span class="line">                        checkRequestResponse.withResponseMarkers(responseHighlights)</span><br><span class="line">                )</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> auditResult(auditIssueList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 被动扫描方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> AuditResult <span class="title function_">passiveAudit</span><span class="params">(HttpRequestResponse baseRequestResponse)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 在响应中搜索预定义的字符串</span></span><br><span class="line">        List&lt;Marker&gt; responseHighlights = getResponseHighlights(baseRequestResponse, GREP_STRING);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果找到字符串，则创建审计问题</span></span><br><span class="line">        List&lt;AuditIssue&gt; auditIssueList = responseHighlights.isEmpty() ? emptyList() : singletonList(</span><br><span class="line">                auditIssue(</span><br><span class="line">                        <span class="string">&quot;CMS Info Leakage&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;The response contains the string: &quot;</span> + GREP_STRING,</span><br><span class="line">                        <span class="literal">null</span>,</span><br><span class="line">                        baseRequestResponse.request().url(),</span><br><span class="line">                        AuditIssueSeverity.HIGH,</span><br><span class="line">                        AuditIssueConfidence.CERTAIN,</span><br><span class="line">                        <span class="literal">null</span>,</span><br><span class="line">                        <span class="literal">null</span>,</span><br><span class="line">                        AuditIssueSeverity.HIGH,</span><br><span class="line">                        baseRequestResponse.withResponseMarkers(responseHighlights)</span><br><span class="line">                )</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> auditResult(auditIssueList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 问题合并策略</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ConsolidationAction <span class="title function_">consolidateIssues</span><span class="params">(AuditIssue newIssue, AuditIssue existingIssue)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 如果问题名称相同，则保留现有问题，否则保留两个问题</span></span><br><span class="line">        <span class="keyword">return</span> existingIssue.name().equals(newIssue.name()) ? KEEP_EXISTING : KEEP_BOTH;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 辅助方法，用于获取响应中匹配字符串的高亮显示</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> List&lt;Marker&gt; <span class="title function_">getResponseHighlights</span><span class="params">(HttpRequestResponse requestResponse, String match)</span></span><br><span class="line">    &#123;</span><br><span class="line">        List&lt;Marker&gt; highlights = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">String</span> <span class="variable">response</span> <span class="operator">=</span> requestResponse.response().toString();</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (start &lt; response.length())</span><br><span class="line">        &#123;</span><br><span class="line">            start = response.indexOf(match, start);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (start == -<span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">Marker</span> <span class="variable">marker</span> <span class="operator">=</span> Marker.marker(start, start+match.length());</span><br><span class="line">            highlights.add(marker);</span><br><span class="line"></span><br><span class="line">            start += match.length();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> highlights;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.BurpExtension;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomScanChecks</span> <span class="keyword">implements</span> <span class="title class_">BurpExtension</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(MontoyaApi api)</span></span><br><span class="line">    &#123;</span><br><span class="line">        api.extension().setName(<span class="string">&quot;Custom Scanner checks&quot;</span>);</span><br><span class="line"></span><br><span class="line">        api.scanner().registerScanCheck(<span class="keyword">new</span> <span class="title class_">MyScanCheck</span>(api));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现原来是Pro版本才有scan功能，重新装了Pro版本</p>
<h2 id="Custom-Session-Tokens-Example-Extension"><a href="#Custom-Session-Tokens-Example-Extension" class="headerlink" title="Custom Session Tokens Example Extension"></a>Custom Session Tokens Example Extension</h2><p>This example demonstrates how you can couple a recorded macro with an extension to automatically gain a session token for a website and use it in later requests that Burp makes.</p>
<p>The macro mechanism that Burp provides allows you to record the request triggering creation of a session made via the proxy.</p>
<p>The extension uses the following techniques:</p>
<ul>
<li>Registers a <code>SessionHandlingAction</code> handler</li>
<li>Fetches the list of macro requests and responses</li>
<li>Extracts the response headers from the last <code>HttprequestResponse</code> item in the list</li>
<li>Finds the relevant session header (in this example, this header is <code>X-Custom-Session-Id</code>)</li>
<li>Returns an <code>HttpRequest</code> with an updated session header</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.HttpHeader;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.HttpRequestResponse;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.requests.HttpRequest;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.sessions.ActionResult;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.sessions.SessionHandlingAction;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.sessions.SessionHandlingActionData;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.http.sessions.ActionResult.actionResult;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现 SessionHandlingAction 接口的类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MySessionHandlingAction</span> <span class="keyword">implements</span> <span class="title class_">SessionHandlingAction</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">name</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Use session token from macro&quot;</span>;  <span class="comment">// 此操作的名称，用于在 Burp Suite 中标识</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ActionResult <span class="title function_">performAction</span><span class="params">(SessionHandlingActionData actionData)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">ActionResult</span> <span class="variable">result</span> <span class="operator">=</span> actionResult(actionData.request(), actionData.annotations());</span><br><span class="line"></span><br><span class="line">        List&lt;HttpRequestResponse&gt; macroRequestResponseList = actionData.macroRequestResponses();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (macroRequestResponseList.isEmpty())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> result;  <span class="comment">// 如果没有从宏中获取到请求响应，直接返回原始结果</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 从最后一个宏响应中提取响应头</span></span><br><span class="line">        List&lt;HttpHeader&gt; headers = macroRequestResponseList.get(macroRequestResponseList.size()-<span class="number">1</span>).response().headers();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 查找会话头部</span></span><br><span class="line">        <span class="type">HttpHeader</span> <span class="variable">sessionHeader</span> <span class="operator">=</span> findSessionHeader(headers);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果没有找到会话令牌，返回未修改的请求</span></span><br><span class="line">        <span class="keyword">if</span> (sessionHeader == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建一个更新了会话头部的 HTTP 请求</span></span><br><span class="line">        <span class="type">HttpRequest</span> <span class="variable">updatedRequest</span> <span class="operator">=</span> actionData.request().withUpdatedHeader(sessionHeader);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> actionResult(updatedRequest, actionData.annotations());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在响应头中查找特定的会话标识符头部</span></span><br><span class="line">    <span class="keyword">private</span> HttpHeader <span class="title function_">findSessionHeader</span><span class="params">(List&lt;HttpHeader&gt; headers)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">HttpHeader</span> <span class="variable">sessionHeader</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(HttpHeader header : headers)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 只处理名为 &quot;X-Custom-Session-Id&quot; 的头部</span></span><br><span class="line">            <span class="keyword">if</span> (!header.name().equals(<span class="string">&quot;X-Custom-Session-Id&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取会话令牌</span></span><br><span class="line">            sessionHeader = header;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sessionHeader;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.BurpExtension;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Burp will auto-detect and load any class that extends BurpExtension.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomSessionTokens</span> <span class="keyword">implements</span> <span class="title class_">BurpExtension</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(MontoyaApi api)</span></span><br><span class="line">    &#123;</span><br><span class="line">        api.extension().setName(<span class="string">&quot;Session token example&quot;</span>);</span><br><span class="line"></span><br><span class="line">        api.http().registerSessionHandlingAction(<span class="keyword">new</span> <span class="title class_">MySessionHandlingAction</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个插件主要用于以下几种场景中：</p>
<ol>
<li><strong>自动化会话管理</strong>：<ul>
<li>在进行自动化渗透测试或功能测试时，特别是当会话令牌需要频繁更新以保持会话活跃的场合，此插件可以自动地从先前的交互（如登录后的响应）中提取新的会话令牌，并用其更新随后的请求。这确保了测试过程中的会话有效性和连续性。</li>
</ul>
</li>
<li><strong>多步骤过程中的令牌管理</strong>：<ul>
<li>在需要执行多个依赖于特定会话状态的步骤的测试中，如购物车添加商品、结账等步骤，此插件能够确保每一步使用正确的会话令牌，从而避免测试因会话过期或令牌失效而失败。</li>
</ul>
</li>
<li><strong>应对防御机制</strong>：<ul>
<li>在目标应用实施了严格的会话管理策略（例如会话固定、会话超时、每次请求后更新令牌等）的情况下，此插件通过动态更新会话令牌来帮助绕过这些机制，允许测试者模拟或维持一个持久的会话状态。</li>
</ul>
</li>
<li><strong>宏和自定义脚本中使用</strong>：<ul>
<li>当使用 Burp Suite 的宏功能进行复杂的预配置任务时，如自动登录并执行一系列操作，此插件可以被配置为宏的一部分，用于在执行宏时自动处理会话令牌的更新。</li>
</ul>
</li>
<li><strong>维持活跃会话</strong>：<ul>
<li>在测试需要长时间运行的脚本或过程时，例如长时间的漏洞扫描或大量数据的传输测试，此插件能够帮助维护会话的活跃状态，避免因会话超时而导致的中断。</li>
</ul>
</li>
</ol>
<h2 id="Custom-Intruder-Payloads-Example-Extension"><a href="#Custom-Intruder-Payloads-Example-Extension" class="headerlink" title="Custom Intruder Payloads Example Extension"></a>Custom Intruder Payloads Example Extension</h2><p>This example shows how you can use an extension to:</p>
<ul>
<li>Generate custom Intruder payloads</li>
<li>Apply custom processing to Intruder payloads (including built-in ones)</li>
</ul>
<p>When an extension registers itself as an Intruder payload provider, this will be available within the Intruder UI for the user to select as the payload source for an attack. When an extension registers itself as a payload processor, the user can create a payload processing rule and select the extension’s processor as the rule’s action.</p>
<p>The extension uses the following techniques:</p>
<ul>
<li>Registers a new <code>PayloadGeneratorProvider</code>, which returns a new <code>PayloadGenerator</code></li>
<li>Registers a new <code>PayloadProcessor</code></li>
<li>The <code>PayloadGenerator</code> does the following:<ul>
<li>Contains a list of payloads to be used</li>
<li>Iterates through the payload list, until there are no longer any payloads available</li>
</ul>
</li>
<li>The <code>PayloadProcessor</code> does the following:<ul>
<li>Decodes the base value of the payload</li>
<li>Parses the location of the <code>input</code> string in the decoded data</li>
<li>Rebuilds the serialized data with the new payload</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> aiassist;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.core.ByteArray;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.intruder.PayloadData;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.intruder.PayloadProcessingResult;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.intruder.PayloadProcessor;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.utilities.Base64Utils;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.utilities.URLUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.intruder.PayloadProcessingResult.usePayload;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现 PayloadProcessor 接口的类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyPayloadProcessor</span> <span class="keyword">implements</span> <span class="title class_">PayloadProcessor</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">INPUT_PREFIX</span> <span class="operator">=</span> <span class="string">&quot;input=&quot;</span>; <span class="comment">// 定义输入前缀，用于解析和重建数据</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MontoyaApi api;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyPayloadProcessor</span><span class="params">(MontoyaApi api)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.api = api; <span class="comment">// 获取 Montoya API 实例</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">displayName</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Serialized input wrapper&quot;</span>; <span class="comment">// 显示名，用于识别处理器</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PayloadProcessingResult <span class="title function_">processPayload</span><span class="params">(PayloadData payloadData)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">Base64Utils</span> <span class="variable">base64Utils</span> <span class="operator">=</span> api.utilities().base64Utils();</span><br><span class="line">        <span class="type">URLUtils</span> <span class="variable">urlUtils</span> <span class="operator">=</span> api.utilities().urlUtils();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 对基础值进行解码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">dataParameter</span> <span class="operator">=</span> base64Utils.decode(urlUtils.decode(payloadData.insertionPoint().baseValue())).toString();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 解析输入字符串在解码数据中的位置</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">prefix</span> <span class="operator">=</span> findPrefix(dataParameter);</span><br><span class="line">        <span class="keyword">if</span> (prefix == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> usePayload(payloadData.currentPayload()); <span class="comment">// 如果没有找到前缀，使用当前负载</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">suffix</span> <span class="operator">=</span> findSuffix(dataParameter);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用新负载重建序列化数据</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">rebuiltDataParameter</span> <span class="operator">=</span> prefix + payloadData.currentPayload() + suffix;</span><br><span class="line">        <span class="type">ByteArray</span> <span class="variable">reserializedDataParameter</span> <span class="operator">=</span> urlUtils.encode(base64Utils.encode(rebuiltDataParameter));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> usePayload(reserializedDataParameter); <span class="comment">// 返回处理后的负载</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">findPrefix</span><span class="params">(String dataParameter)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> dataParameter.indexOf(INPUT_PREFIX);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (start == -<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>; <span class="comment">// 如果没有找到前缀，返回 null</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        start += INPUT_PREFIX.length();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> dataParameter.substring(<span class="number">0</span>, start);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">findSuffix</span><span class="params">(String dataParameter)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> dataParameter.indexOf(INPUT_PREFIX);</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">end</span> <span class="operator">=</span> dataParameter.indexOf(<span class="string">&quot;&amp;&quot;</span>, start);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (end == -<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            end = dataParameter.length();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> dataParameter.substring(end);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.intruder.AttackConfiguration;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.intruder.PayloadGenerator;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.intruder.PayloadGeneratorProvider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyPayloadGeneratorProvider</span> <span class="keyword">implements</span> <span class="title class_">PayloadGeneratorProvider</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">displayName</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;My custom payloads&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PayloadGenerator <span class="title function_">providePayloadGenerator</span><span class="params">(AttackConfiguration attackConfiguration)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyPayloadGenerator</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.intruder.GeneratedPayload;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.intruder.IntruderInsertionPoint;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.intruder.PayloadGenerator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyPayloadGenerator</span> <span class="keyword">implements</span> <span class="title class_">PayloadGenerator</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> List&lt;String&gt; PAYLOADS = List.of(<span class="string">&quot;|&quot;</span>, <span class="string">&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> payloadIndex;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> GeneratedPayload <span class="title function_">generatePayloadFor</span><span class="params">(IntruderInsertionPoint insertionPoint)</span></span><br><span class="line">    &#123;</span><br><span class="line">        payloadIndex++;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (payloadIndex &gt; PAYLOADS.size())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> GeneratedPayload.end();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">payload</span> <span class="operator">=</span> PAYLOADS.get(payloadIndex);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> GeneratedPayload.payload(payload);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.BurpExtension;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IntruderPayloads</span> <span class="keyword">implements</span> <span class="title class_">BurpExtension</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(MontoyaApi api)</span></span><br><span class="line">    &#123;</span><br><span class="line">        api.extension().setName(<span class="string">&quot;Intruder payloads&quot;</span>);</span><br><span class="line"></span><br><span class="line">        api.intruder().registerPayloadGeneratorProvider(<span class="keyword">new</span> <span class="title class_">MyPayloadGeneratorProvider</span>());</span><br><span class="line">        api.intruder().registerPayloadProcessor(<span class="keyword">new</span> <span class="title class_">MyPayloadProcessor</span>(api));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/10/24/tools/burpsuite-plugins2/image.png" alt="在这里可以选择生成payload的方式"></p>
<h2 id="Persistence-Example-Extension"><a href="#Persistence-Example-Extension" class="headerlink" title="Persistence Example Extension"></a>Persistence Example Extension</h2><p>The extension works as follows:</p>
<ul>
<li>It saves and loads a simple incrementing integer value with the project file.<ul>
<li>Sends to the event log how many times Burp or the extension were restarted.</li>
</ul>
</li>
<li>It saves and loads extension built http requests<ul>
<li>Sends the  requests to repeater with an incrementing tab counter when Burp is restarted or the extension is reloaded.</li>
</ul>
</li>
<li>It saves the last 5 requests&#x2F;responses issued by Burp<ul>
<li>Prints the last 5 request&#x2F;responses to the output log when burp is restarted or the extension is reloaded. </li>
<li>Uses Persisted Lists to automatically save&#x2F;load data stored in the list.</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.requests.HttpRequest;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.persistence.PersistedObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.http.message.requests.HttpRequest.httpRequest;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.http.message.requests.HttpRequest.httpRequestFromUrl;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> example.persistence.PersistenceExample.STARTUP_COUNT_KEY;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SavingLoadingRequests</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SIMPLE_REQUEST_KEY</span> <span class="operator">=</span> <span class="string">&quot;simpleRequest&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">REQUEST_WITH_HEADERS_KEY</span> <span class="operator">=</span> <span class="string">&quot;requestWithHeaders&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">REQUEST_FROM_URL_KEY</span> <span class="operator">=</span> <span class="string">&quot;requestFromUrl&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MontoyaApi api;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> PersistedObject myExtensionData;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造函数</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SavingLoadingRequests</span><span class="params">(MontoyaApi api)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.api = api;</span><br><span class="line">        <span class="built_in">this</span>.myExtensionData = api.persistence().extensionData();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 运行示例</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">runExample</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 检查是否已经保存了示例请求</span></span><br><span class="line">        <span class="keyword">if</span> (!checkForRequests()) &#123;</span><br><span class="line">            api.logging().raiseInfoEvent(<span class="string">&quot;No Requests saved, creating requests&quot;</span>);</span><br><span class="line">            createAndSaveExampleRequests();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        sendExampleRequestsToRepeaterWithStartupCount();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检查是否存在保存的请求</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">checkForRequests</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 获取保存的 HTTP 请求的键集合，并检查所需的键是否都存在</span></span><br><span class="line">        <span class="keyword">return</span> myExtensionData.httpRequestKeys().contains(SIMPLE_REQUEST_KEY) &amp;&amp;</span><br><span class="line">                myExtensionData.httpRequestKeys().contains(REQUEST_WITH_HEADERS_KEY) &amp;&amp;</span><br><span class="line">                myExtensionData.httpRequestKeys().contains(REQUEST_FROM_URL_KEY);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建并保存示例请求</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">createAndSaveExampleRequests</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">HttpRequest</span> <span class="variable">simpleRequest</span> <span class="operator">=</span> httpRequest(<span class="string">&quot;GET / HTTP1.0\r\n\r\n&quot;</span>);</span><br><span class="line">        <span class="type">HttpRequest</span> <span class="variable">requestWithHeaders</span> <span class="operator">=</span> httpRequest(<span class="string">&quot;GET / HTTP1.1\r\nHost: localhost\r\nMyHeader: Example\r\n\r\n&quot;</span>);</span><br><span class="line">        <span class="type">HttpRequest</span> <span class="variable">requestFromUrl</span> <span class="operator">=</span> httpRequestFromUrl(<span class="string">&quot;http://localhost&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将每个请求保存到其对应的键下</span></span><br><span class="line">        myExtensionData.setHttpRequest(SIMPLE_REQUEST_KEY, simpleRequest);</span><br><span class="line">        myExtensionData.setHttpRequest(REQUEST_WITH_HEADERS_KEY, requestWithHeaders);</span><br><span class="line">        myExtensionData.setHttpRequest(REQUEST_FROM_URL_KEY, requestFromUrl);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将请求发送到 Repeater，并在标签名称中加入启动计数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">sendExampleRequestsToRepeaterWithStartupCount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">HttpRequest</span> <span class="variable">simpleRequest</span> <span class="operator">=</span> myExtensionData.getHttpRequest(SIMPLE_REQUEST_KEY);</span><br><span class="line">        <span class="type">HttpRequest</span> <span class="variable">requestWithHeaders</span> <span class="operator">=</span> myExtensionData.getHttpRequest(REQUEST_WITH_HEADERS_KEY);</span><br><span class="line">        <span class="type">HttpRequest</span> <span class="variable">requestFromUrl</span> <span class="operator">=</span> myExtensionData.getHttpRequest(REQUEST_FROM_URL_KEY);</span><br><span class="line"></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">startupCount</span> <span class="operator">=</span> myExtensionData.getInteger(STARTUP_COUNT_KEY);</span><br><span class="line"></span><br><span class="line">        api.repeater().sendToRepeater(simpleRequest, <span class="string">&quot;Simple Request &quot;</span> + startupCount);</span><br><span class="line">        api.repeater().sendToRepeater(requestWithHeaders, <span class="string">&quot;Request With Headers &quot;</span> + startupCount);</span><br><span class="line">        api.repeater().sendToRepeater(requestFromUrl, <span class="string">&quot;Request From Url &quot;</span> + startupCount);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.handler.*;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.HttpRequestResponse;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.persistence.PersistedList;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.persistence.PersistedObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.http.handler.RequestToBeSentAction.continueWith;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.http.handler.ResponseReceivedAction.continueWith;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.http.message.HttpRequestResponse.httpRequestResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestResponseLogging</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">REQUEST_RESPONSE_LIST_KEY</span> <span class="operator">=</span> <span class="string">&quot;last5&quot;</span>;  <span class="comment">// 用于保存数据的键</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MontoyaApi api;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> PersistedObject myExtensionData;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RequestResponseLogging</span><span class="params">(MontoyaApi api)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.api = api;</span><br><span class="line">        <span class="built_in">this</span>.myExtensionData = api.persistence().extensionData();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">runExample</span><span class="params">()</span> &#123;</span><br><span class="line">        ensurePersistedListIsPresent();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 从项目文件中加载请求/响应列表</span></span><br><span class="line">        PersistedList&lt;HttpRequestResponse&gt; myPersistedList = myExtensionData.getHttpRequestResponseList(REQUEST_RESPONSE_LIST_KEY);</span><br><span class="line">        printToOutput(myPersistedList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 注册 HTTP 处理器来处理请求和响应</span></span><br><span class="line">        api.http().registerHttpHandler(<span class="keyword">new</span> <span class="title class_">HttpHandler</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> RequestToBeSentAction <span class="title function_">handleHttpRequestToBeSent</span><span class="params">(HttpRequestToBeSent requestToBeSent)</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> continueWith(requestToBeSent);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">synchronized</span> ResponseReceivedAction <span class="title function_">handleHttpResponseReceived</span><span class="params">(HttpResponseReceived responseReceived)</span> &#123;</span><br><span class="line">                <span class="comment">// 保持列表中最多 5 条记录</span></span><br><span class="line">                <span class="keyword">if</span> (myPersistedList.size() &gt;= <span class="number">5</span>) &#123;</span><br><span class="line">                    myPersistedList.remove(<span class="number">0</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 为了日志记录，我们不需要保留正文内容</span></span><br><span class="line">                myPersistedList.add(httpRequestResponse(responseReceived.initiatingRequest().withBody(<span class="string">&quot;&quot;</span>), responseReceived.withBody(<span class="string">&quot;&quot;</span>)));</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> continueWith(responseReceived);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">printToOutput</span><span class="params">(PersistedList&lt;HttpRequestResponse&gt; myPersistedList)</span> &#123;</span><br><span class="line">        <span class="comment">// 将加载的列表打印到输出日志</span></span><br><span class="line">        <span class="keyword">for</span> (HttpRequestResponse httpRequestResponse : myPersistedList) &#123;</span><br><span class="line">            api.logging().logToOutput(httpRequestResponse.request().toString());</span><br><span class="line">            api.logging().logToOutput(<span class="string">&quot;\n========================\n&quot;</span>);</span><br><span class="line">            api.logging().logToOutput(httpRequestResponse.response().toString());</span><br><span class="line">            api.logging().logToOutput(<span class="string">&quot;\n**************************&quot;</span>.repeat(<span class="number">2</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">ensurePersistedListIsPresent</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 创建持久化的请求/响应列表</span></span><br><span class="line">        <span class="keyword">if</span> (myExtensionData.getHttpRequestResponseList(REQUEST_RESPONSE_LIST_KEY) == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 创建一个新的空列表并将其保存到我们的键下</span></span><br><span class="line">            PersistedList&lt;HttpRequestResponse&gt; emptyPersistedList = PersistedList.persistedHttpRequestResponseList();</span><br><span class="line">            myExtensionData.setHttpRequestResponseList(REQUEST_RESPONSE_LIST_KEY, emptyPersistedList);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PersistenceExample</span> <span class="keyword">implements</span> <span class="title class_">BurpExtension</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">STARTUP_COUNT_KEY</span> <span class="operator">=</span> <span class="string">&quot;Startup Count&quot;</span>;  <span class="comment">// 用于保存启动次数的键</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(MontoyaApi api)</span> &#123;</span><br><span class="line">        <span class="comment">// 为扩展设置名称，持久化数据将基于此名称进行保存和加载</span></span><br><span class="line">        api.extension().setName(<span class="string">&quot;Persistence example extension&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取持久化对象，用于保存或加载数据</span></span><br><span class="line">        <span class="type">PersistedObject</span> <span class="variable">myExtensionData</span> <span class="operator">=</span> api.persistence().extensionData();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 从项目文件中获取整数值</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">startupCount</span> <span class="operator">=</span> myExtensionData.getInteger(STARTUP_COUNT_KEY);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果值不存在，即此键未在项目文件中找到，则初始化为0</span></span><br><span class="line">        <span class="keyword">if</span> (startupCount == <span class="literal">null</span>) &#123;</span><br><span class="line">            startupCount = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将启动次数增加1并保存回项目文件</span></span><br><span class="line">        myExtensionData.setInteger(STARTUP_COUNT_KEY, startupCount + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 从持久化数据中检索更新后的值并创建一个信息事件</span></span><br><span class="line">        api.logging().raiseInfoEvent(<span class="string">&quot;Startup count is: &quot;</span> + myExtensionData.getInteger(STARTUP_COUNT_KEY));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 运行更复杂的示例，例如保存和加载请求</span></span><br><span class="line">        advancedExamples(api);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 运行高级示例</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">advancedExamples</span><span class="params">(MontoyaApi api)</span> &#123;</span><br><span class="line">        <span class="comment">// 保存和加载请求的示例</span></span><br><span class="line">        <span class="type">SavingLoadingRequests</span> <span class="variable">savingLoadingRequests</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SavingLoadingRequests</span>(api);</span><br><span class="line">        savingLoadingRequests.runExample();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使用请求响应列表的示例</span></span><br><span class="line">        <span class="type">RequestResponseLogging</span> <span class="variable">requestLogging</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RequestResponseLogging</span>(api);</span><br><span class="line">        requestLogging.runExample();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="WebSocket-Handler-Example-Extension"><a href="#WebSocket-Handler-Example-Extension" class="headerlink" title="WebSocket Handler Example Extension"></a>WebSocket Handler Example Extension</h2><p>The extension works as follows:</p>
<ul>
<li>It registers a web socket created handler</li>
<li>When a web socket is created<ul>
<li>It sends an initial text message</li>
<li>It registers a message listener for the websocket</li>
<li>Any message from the client that contains the text “password” is base64 encoded.</li>
</ul>
</li>
</ul>
<p>这个先不看了</p>
<h2 id="Menu-Bar-Example-Extension"><a href="#Menu-Bar-Example-Extension" class="headerlink" title="Menu Bar Example Extension"></a>Menu Bar Example Extension</h2><p>This extension demonstrates registering a top level menu bar item with various actions.</p>
<p>It demonstrates the following techniques:</p>
<p>Creating a BasicMenuItem with a caption<br>Providing an action for a BasicMenuItem<br>Adding the Menu to Burp<br>Registering an ExtensionUnloadingHandler</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.extension.ExtensionUnloadingHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyExtensionUnloadingHandler</span> <span class="keyword">implements</span> <span class="title class_">ExtensionUnloadingHandler</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MontoyaApi api;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyExtensionUnloadingHandler</span><span class="params">(MontoyaApi api)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.api = api;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">extensionUnloaded</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        api.logging().logToOutput(<span class="string">&quot;Extension has been unloaded.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.BurpExtension;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.ui.menu.BasicMenuItem;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.ui.menu.Menu;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.ui.menu.MenuItem;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MenuBar</span> <span class="keyword">implements</span> <span class="title class_">BurpExtension</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(MontoyaApi api)</span></span><br><span class="line">    &#123;</span><br><span class="line">        api.extension().setName(<span class="string">&quot;Add menu bar&quot;</span>);</span><br><span class="line">        api.logging().logToOutput(<span class="string">&quot;Extension has been loaded.&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">BasicMenuItem</span> <span class="variable">alertEventItem</span> <span class="operator">=</span> BasicMenuItem.basicMenuItem(<span class="string">&quot;Raise critical alert&quot;</span>).withAction(() -&gt; api.logging().raiseCriticalEvent(<span class="string">&quot;Alert from extension&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="type">BasicMenuItem</span> <span class="variable">basicMenuItem</span> <span class="operator">=</span> MenuItem.basicMenuItem(<span class="string">&quot;Unload extension&quot;</span>);</span><br><span class="line">        <span class="type">MenuItem</span> <span class="variable">unloadExtensionItem</span> <span class="operator">=</span> basicMenuItem.withAction(() -&gt; api.extension().unload());</span><br><span class="line"></span><br><span class="line">        <span class="type">Menu</span> <span class="variable">menu</span> <span class="operator">=</span> Menu.menu(<span class="string">&quot;Menu bar&quot;</span>).withMenuItems(alertEventItem, unloadExtensionItem);</span><br><span class="line"></span><br><span class="line">        api.userInterface().menuBar().registerMenu(menu);</span><br><span class="line"></span><br><span class="line">        api.extension().registerUnloadingHandler(<span class="keyword">new</span> <span class="title class_">MyExtensionUnloadingHandler</span>(api));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Context-Menu-Example-Extension"><a href="#Context-Menu-Example-Extension" class="headerlink" title="Context Menu Example Extension"></a>Context Menu Example Extension</h2><p>This extension adds a new context menu item to print out the request or response of an HttpRequestResponse in the Target, Proxy or Logger tab.</p>
<p>The sample extension demonstrates the following techniques:</p>
<p>Registering a new ContextMenuItemsProvider.<br>Creating a JMenuItem.<br>Adding an action listener to a JMenuItem.<br>If you right-click in a message editor context, it will use the item from the message editor.<br>If you right-click on a table item, it will print the request&#x2F;response for the first selected item.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyContextMenuItemsProvider</span> <span class="keyword">implements</span> <span class="title class_">ContextMenuItemsProvider</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MontoyaApi api;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyContextMenuItemsProvider</span><span class="params">(MontoyaApi api)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.api = api;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Component&gt; <span class="title function_">provideMenuItems</span><span class="params">(ContextMenuEvent event)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (event.isFromTool(ToolType.PROXY, ToolType.TARGET, ToolType.LOGGER))</span><br><span class="line">        &#123;</span><br><span class="line">            List&lt;Component&gt; menuItemList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">            <span class="type">JMenuItem</span> <span class="variable">retrieveRequestItem</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JMenuItem</span>(<span class="string">&quot;Print request&quot;</span>);</span><br><span class="line">            <span class="type">JMenuItem</span> <span class="variable">retrieveResponseItem</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JMenuItem</span>(<span class="string">&quot;Print response&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="type">HttpRequestResponse</span> <span class="variable">requestResponse</span> <span class="operator">=</span> event.messageEditorRequestResponse().isPresent() ? event.messageEditorRequestResponse().get().requestResponse() : event.selectedRequestResponses().get(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            retrieveRequestItem.addActionListener(l -&gt; api.logging().logToOutput(<span class="string">&quot;Request is:\r\n&quot;</span> + requestResponse.request().toString()));</span><br><span class="line">            menuItemList.add(retrieveRequestItem);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (requestResponse.response() != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                retrieveResponseItem.addActionListener(l -&gt; api.logging().logToOutput(<span class="string">&quot;Response is:\r\n&quot;</span> + requestResponse.response().toString()));</span><br><span class="line">                menuItemList.add(retrieveResponseItem);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> menuItemList;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.BurpExtension;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ContextMenu</span> <span class="keyword">implements</span> <span class="title class_">BurpExtension</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(MontoyaApi api)</span></span><br><span class="line">    &#123;</span><br><span class="line">        api.extension().setName(<span class="string">&quot;Context menu extension&quot;</span>);</span><br><span class="line"></span><br><span class="line">        api.userInterface().registerContextMenuItemsProvider(<span class="keyword">new</span> <span class="title class_">MyContextMenuItemsProvider</span>(api));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面代码是创建右键处理选项的</p>

  </div>
</article>


    <div class="blog-post-comments">
        <div id="utterances_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/categories/">Categories</a></li>
        
          <li><a href="/idea/">Idea</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/g0dam">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Custom-Scan-Checks-Example-Extension"><span class="toc-number">1.</span> <span class="toc-text">Custom Scan Checks Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Custom-Session-Tokens-Example-Extension"><span class="toc-number">2.</span> <span class="toc-text">Custom Session Tokens Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Custom-Intruder-Payloads-Example-Extension"><span class="toc-number">3.</span> <span class="toc-text">Custom Intruder Payloads Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Persistence-Example-Extension"><span class="toc-number">4.</span> <span class="toc-text">Persistence Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WebSocket-Handler-Example-Extension"><span class="toc-number">5.</span> <span class="toc-text">WebSocket Handler Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Menu-Bar-Example-Extension"><span class="toc-number">6.</span> <span class="toc-text">Menu Bar Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Context-Menu-Example-Extension"><span class="toc-number">7.</span> <span class="toc-text">Context Menu Example Extension</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&text=【工具开发】Burpsuite 插件开发 2"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&title=【工具开发】Burpsuite 插件开发 2"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&is_video=false&description=【工具开发】Burpsuite 插件开发 2"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=【工具开发】Burpsuite 插件开发 2&body=Check out this article: https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&title=【工具开发】Burpsuite 插件开发 2"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&title=【工具开发】Burpsuite 插件开发 2"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&title=【工具开发】Burpsuite 插件开发 2"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&title=【工具开发】Burpsuite 插件开发 2"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&name=【工具开发】Burpsuite 插件开发 2&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://godreams.cn/2024/10/24/tools/burpsuite-plugins2/&t=【工具开发】Burpsuite 插件开发 2"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2024-2025
    g0dam
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/categories/">Categories</a></li><!--
     --><!--
       --><li><a href="/idea/">Idea</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/g0dam">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

    <script type="text/javascript">
      var utterances_repo = 'owner/githubrepo';
      var utterances_issue_term = 'pathname';
      var utterances_label = 'Comment';
      var utterances_theme = 'github-dark';

      (function(){
          var script = document.createElement('script');

          script.src = 'https://utteranc.es/client.js';
          script.setAttribute('repo', utterances_repo);
          script.setAttribute('issue-term', 'pathname');
          script.setAttribute('label', utterances_label);
          script.setAttribute('theme', utterances_theme);
          script.setAttribute('crossorigin', 'anonymous');
          script.async = true;
          (document.getElementById('utterances_thread')).appendChild(script);
      }());
  </script>

</body>
</html>
