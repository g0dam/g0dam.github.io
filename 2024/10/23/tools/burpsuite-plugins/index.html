<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="想写一个burpsuite插件，看到burpsuite更新了最新的api，首先通过学习官网的github示例学习下api功能使用https:&#x2F;&#x2F;github.com&#x2F;PortSwigger&#x2F;burp-extensions-montoya-api-examples Hello World123456789101112131415161718192021222324252627282930313233">
<meta property="og:type" content="article">
<meta property="og:title" content="【工具开发】Burpsuite 插件开发">
<meta property="og:url" content="https://godreams.cn/2024/10/23/tools/burpsuite-plugins/index.html">
<meta property="og:site_name" content="g0dam">
<meta property="og:description" content="想写一个burpsuite插件，看到burpsuite更新了最新的api，首先通过学习官网的github示例学习下api功能使用https:&#x2F;&#x2F;github.com&#x2F;PortSwigger&#x2F;burp-extensions-montoya-api-examples Hello World123456789101112131415161718192021222324252627282930313233">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://godreams.cn/2024/10/23/tools/burpsuite-plugins/image.png">
<meta property="og:image" content="https://godreams.cn/2024/10/23/tools/burpsuite-plugins/image-1.png">
<meta property="og:image" content="https://godreams.cn/2024/10/23/tools/burpsuite-plugins/image-2.png">
<meta property="og:image" content="https://godreams.cn/2024/10/23/tools/burpsuite-plugins/image-3.png">
<meta property="og:image" content="https://godreams.cn/2024/10/23/tools/burpsuite-plugins/image-4.png">
<meta property="og:image" content="https://godreams.cn/2024/10/23/tools/burpsuite-plugins/image-5.png">
<meta property="article:published_time" content="2024-10-23T12:33:09.000Z">
<meta property="article:modified_time" content="2024-10-24T10:17:13.728Z">
<meta property="article:author" content="g0dam">
<meta property="article:tag" content="burpsuite">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://godreams.cn/2024/10/23/tools/burpsuite-plugins/image.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>【工具开发】Burpsuite 插件开发</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/true" title="g0dam" type="application/atom+xml" />
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/categories/">Categories</a></li><!--
     --><!--
       --><li><a href="/idea/">Idea</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/g0dam">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2024/10/24/tools/burpsuite-plugins2/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2024/10/22/WebSecurity/cve/CVE-2017-10271/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&text=【工具开发】Burpsuite 插件开发"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&title=【工具开发】Burpsuite 插件开发"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&is_video=false&description=【工具开发】Burpsuite 插件开发"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=【工具开发】Burpsuite 插件开发&body=Check out this article: https://godreams.cn/2024/10/23/tools/burpsuite-plugins/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&title=【工具开发】Burpsuite 插件开发"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&title=【工具开发】Burpsuite 插件开发"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&title=【工具开发】Burpsuite 插件开发"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&title=【工具开发】Burpsuite 插件开发"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&name=【工具开发】Burpsuite 插件开发&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&t=【工具开发】Burpsuite 插件开发"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Hello-World"><span class="toc-number">1.</span> <span class="toc-text">Hello World</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP-Handler-Example-Extension"><span class="toc-number">2.</span> <span class="toc-text">HTTP Handler Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Proxy-Handler-Example-Extension"><span class="toc-number">3.</span> <span class="toc-text">Proxy Handler Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Event-Listeners-Example-Extension"><span class="toc-number">4.</span> <span class="toc-text">Event Listeners Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Traffic-Redirector-Example-Extension"><span class="toc-number">5.</span> <span class="toc-text">Traffic Redirector Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Custom-Logger-Example-Extension"><span class="toc-number">6.</span> <span class="toc-text">Custom Logger Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Custom-Request-Editor-Tab-Example-Extension"><span class="toc-number">7.</span> <span class="toc-text">Custom Request Editor Tab Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Custom-Scan-Checks-Example-Extension"><span class="toc-number">8.</span> <span class="toc-text">Custom Scan Checks Example Extension</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        【工具开发】Burpsuite 插件开发
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">g0dam</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-10-23T12:33:09.000Z" class="dt-published" itemprop="datePublished">2024-10-23</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/Tools/">Tools</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/burpsuite/" rel="tag">burpsuite</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>想写一个burpsuite插件，看到burpsuite更新了最新的api，首先通过学习官网的github示例学习下api功能使用<br><a target="_blank" rel="noopener" href="https://github.com/PortSwigger/burp-extensions-montoya-api-examples">https://github.com/PortSwigger/burp-extensions-montoya-api-examples</a></p>
<h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> example.helloworld;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.BurpExtension;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.logging.Logging;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Burp will auto-detect and load any class that extends BurpExtension.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorld</span> <span class="keyword">implements</span> <span class="title class_">BurpExtension</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(MontoyaApi api)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// set extension name</span></span><br><span class="line">        api.extension().setName(<span class="string">&quot;Hello world extension&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Logging</span> <span class="variable">logging</span> <span class="operator">=</span> api.logging();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// write a message to our output stream</span></span><br><span class="line">        logging.logToOutput(<span class="string">&quot;Hello output.&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// write a message to our error stream</span></span><br><span class="line">        logging.logToError(<span class="string">&quot;Hello error.&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// write a message to the Burp alerts tab</span></span><br><span class="line">        logging.raiseInfoEvent(<span class="string">&quot;Hello info event.&quot;</span>);</span><br><span class="line">        logging.raiseDebugEvent(<span class="string">&quot;Hello debug event.&quot;</span>);</span><br><span class="line">        logging.raiseErrorEvent(<span class="string">&quot;Hello error event.&quot;</span>);</span><br><span class="line">        logging.raiseCriticalEvent(<span class="string">&quot;Hello critical event.&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// throw an exception that will appear in our error stream</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Hello exception.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面代码的logging是输出在这里的：<br><img src="/2024/10/23/tools/burpsuite-plugins/image.png"><br>可以用来输出自动化扫描后的结果</p>
<h2 id="HTTP-Handler-Example-Extension"><a href="#HTTP-Handler-Example-Extension" class="headerlink" title="HTTP Handler Example Extension"></a>HTTP Handler Example Extension</h2><p>它注册一个 HTTP 处理程序<br>对于传出请求消息：<br>    如果请求是请求：POST<br>        请求正文将记录到 output<br>        将向请求添加注释<br>    将 URL 参数添加到请求中<br>对于传入的响应消息：<br>    如果相应的请求包含标头，则会添加高亮显示Content-LengthBLUE</p>
<p>MyHttpHandler.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.core.Annotations;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.core.HighlightColor;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.handler.*;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.requests.HttpRequest;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.logging.Logging;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.http.handler.RequestToBeSentAction.continueWith;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.http.handler.ResponseReceivedAction.continueWith;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.http.message.params.HttpParameter.urlParameter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyHttpHandler</span> <span class="keyword">implements</span> <span class="title class_">HttpHandler</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Logging logging;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyHttpHandler</span><span class="params">(MontoyaApi api)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.logging = api.logging();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> RequestToBeSentAction <span class="title function_">handleHttpRequestToBeSent</span><span class="params">(HttpRequestToBeSent requestToBeSent)</span> &#123;</span><br><span class="line">        <span class="type">Annotations</span> <span class="variable">annotations</span> <span class="operator">=</span> requestToBeSent.annotations();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// If the request is a post, log the body and add notes.</span></span><br><span class="line">        <span class="keyword">if</span> (isPost(requestToBeSent)) &#123;</span><br><span class="line">            annotations = annotations.withNotes(<span class="string">&quot;Request was a post&quot;</span>);</span><br><span class="line">            logging.logToOutput(requestToBeSent.bodyToString());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Modify the request by adding url param.</span></span><br><span class="line">        <span class="type">HttpRequest</span> <span class="variable">modifiedRequest</span> <span class="operator">=</span> requestToBeSent.withAddedParameters(urlParameter(<span class="string">&quot;foo&quot;</span>, <span class="string">&quot;bar&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Return the modified request to burp with updated annotations.</span></span><br><span class="line">        <span class="keyword">return</span> continueWith(modifiedRequest, annotations);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ResponseReceivedAction <span class="title function_">handleHttpResponseReceived</span><span class="params">(HttpResponseReceived responseReceived)</span> &#123;</span><br><span class="line">        <span class="type">Annotations</span> <span class="variable">annotations</span> <span class="operator">=</span> responseReceived.annotations();</span><br><span class="line">        <span class="comment">//Highlight all responses where the request had a Content-Length header.</span></span><br><span class="line">        <span class="keyword">if</span> (responseHasContentLengthHeader(responseReceived)) &#123;</span><br><span class="line">            annotations = annotations.withHighlightColor(HighlightColor.BLUE);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> continueWith(responseReceived, annotations);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isPost</span><span class="params">(HttpRequestToBeSent httpRequestToBeSent)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> httpRequestToBeSent.method().equalsIgnoreCase(<span class="string">&quot;POST&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">responseHasContentLengthHeader</span><span class="params">(HttpResponseReceived httpResponseReceived)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> httpResponseReceived.initiatingRequest().headers().stream().anyMatch(header -&gt; header.name().equalsIgnoreCase(<span class="string">&quot;Content-Length&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>HttpHandlerExample.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> burp.api.montoya.BurpExtension;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Burp will auto-detect and load any class that extends BurpExtension.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HttpHandlerExample</span> <span class="keyword">implements</span> <span class="title class_">BurpExtension</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(MontoyaApi api)</span> &#123;</span><br><span class="line">        api.extension().setName(<span class="string">&quot;HTTP Handler Example&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Register our http handler with Burp.</span></span><br><span class="line">        api.http().registerHttpHandler(<span class="keyword">new</span> <span class="title class_">MyHttpHandler</span>(api));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Proxy-Handler-Example-Extension"><a href="#Proxy-Handler-Example-Extension" class="headerlink" title="Proxy Handler Example Extension"></a>Proxy Handler Example Extension</h2><p>The extension works as follows:</p>
<ul>
<li>It registers a Proxy handler</li>
<li>For outgoing request messages:<ul>
<li>It drops all <code>POST</code> requests</li>
<li>Requests with <code>foo</code> in the URL are not intercepted</li>
<li>If the <code>Content-Type</code> is <code>JSON</code>, the request is highlighted <code>RED</code> and Burp rules for Interception are followed</li>
<li>All other requests are intercepted</li>
<li>User modified requests are continued as normal</li>
</ul>
</li>
<li>For incoming response messages:<ul>
<li>All responses that contain the string <code>username</code> are highlighted <code>BLUE</code></li>
<li>All other responses follow Burp rules for Interception</li>
</ul>
</li>
</ul>
<p>ProxyHandlerExample.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> burp.api.montoya.BurpExtension;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Burp will auto-detect and load any class that extends BurpExtension.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyHandlerExample</span> <span class="keyword">implements</span> <span class="title class_">BurpExtension</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(MontoyaApi api)</span></span><br><span class="line">    &#123;</span><br><span class="line">        api.extension().setName(<span class="string">&quot;Proxy Handler Example&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Register proxy handlers with Burp.</span></span><br><span class="line">        api.proxy().registerRequestHandler(<span class="keyword">new</span> <span class="title class_">MyProxyHttpRequestHandler</span>());</span><br><span class="line">        api.proxy().registerResponseHandler(<span class="keyword">new</span> <span class="title class_">MyProxyHttpResponseHandler</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>MyProxyHttpResponseHandler.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> burp.api.montoya.proxy.http.InterceptedResponse;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.proxy.http.ProxyResponseHandler;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.proxy.http.ProxyResponseReceivedAction;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.proxy.http.ProxyResponseToBeSentAction;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.core.HighlightColor.BLUE;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyProxyHttpResponseHandler</span> <span class="keyword">implements</span> <span class="title class_">ProxyResponseHandler</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ProxyResponseReceivedAction <span class="title function_">handleResponseReceived</span><span class="params">(InterceptedResponse interceptedResponse)</span> &#123;</span><br><span class="line">        <span class="comment">//Highlight all responses that have username in them</span></span><br><span class="line">        <span class="keyword">if</span> (interceptedResponse.bodyToString().contains(<span class="string">&quot;username&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> ProxyResponseReceivedAction.continueWith(interceptedResponse, interceptedResponse.annotations().withHighlightColor(BLUE));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ProxyResponseReceivedAction.continueWith(interceptedResponse);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ProxyResponseToBeSentAction <span class="title function_">handleResponseToBeSent</span><span class="params">(InterceptedResponse interceptedResponse)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ProxyResponseToBeSentAction.continueWith(interceptedResponse);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>MyProxyHttpRequestHandler.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> burp.api.montoya.proxy.http.InterceptedRequest;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.proxy.http.ProxyRequestHandler;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.proxy.http.ProxyRequestReceivedAction;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.proxy.http.ProxyRequestToBeSentAction;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.core.HighlightColor.RED;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.http.message.ContentType.JSON;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyProxyHttpRequestHandler</span> <span class="keyword">implements</span> <span class="title class_">ProxyRequestHandler</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ProxyRequestReceivedAction <span class="title function_">handleRequestReceived</span><span class="params">(InterceptedRequest interceptedRequest)</span> &#123;</span><br><span class="line">        <span class="comment">//Drop all post requests</span></span><br><span class="line">        <span class="keyword">if</span> (interceptedRequest.method().equals(<span class="string">&quot;POST&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> ProxyRequestReceivedAction.drop();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Do not intercept any request with foo in the url</span></span><br><span class="line">        <span class="keyword">if</span> (interceptedRequest.url().contains(<span class="string">&quot;foo&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> ProxyRequestReceivedAction.doNotIntercept(interceptedRequest);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//If the content type is json, highlight the request and follow burp rules for interception</span></span><br><span class="line">        <span class="keyword">if</span> (interceptedRequest.contentType() == JSON) &#123;</span><br><span class="line">            <span class="keyword">return</span> ProxyRequestReceivedAction.continueWith(interceptedRequest, interceptedRequest.annotations().withHighlightColor(RED));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Intercept all other requests</span></span><br><span class="line">        <span class="keyword">return</span> ProxyRequestReceivedAction.intercept(interceptedRequest);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ProxyRequestToBeSentAction <span class="title function_">handleRequestToBeSent</span><span class="params">(InterceptedRequest interceptedRequest)</span> &#123;</span><br><span class="line">        <span class="comment">//Do nothing with the user modified request, continue as normal.</span></span><br><span class="line">        <span class="keyword">return</span> ProxyRequestToBeSentAction.continueWith(interceptedRequest);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/10/23/tools/burpsuite-plugins/image-1.png"><br>观察可以看到上面的代码似乎已经取代了我这里的拦截，因为即便是拦截关闭的话，也依旧是拦截状态</p>
<h2 id="Event-Listeners-Example-Extension"><a href="#Event-Listeners-Example-Extension" class="headerlink" title="Event Listeners Example Extension"></a>Event Listeners Example Extension</h2><p>This extension demonstrates how to register listeners for various runtime events:</p>
<ul>
<li>HTTP requests and responses for all Burp tools.</li>
<li>HTTP messages intercepted by the Proxy.</li>
<li>Addition of new scan issues.</li>
<li>The extension being unloaded by the user.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EventListeners</span> <span class="keyword">implements</span> <span class="title class_">BurpExtension</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Logging logging;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(MontoyaApi api)</span> &#123;</span><br><span class="line">        logging = api.logging();</span><br><span class="line"></span><br><span class="line">        <span class="type">Http</span> <span class="variable">http</span> <span class="operator">=</span> api.http();</span><br><span class="line">        <span class="type">Proxy</span> <span class="variable">proxy</span> <span class="operator">=</span> api.proxy();</span><br><span class="line">        <span class="type">Extension</span> <span class="variable">extension</span> <span class="operator">=</span> api.extension();</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> api.scanner();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// set extension name</span></span><br><span class="line">        extension.setName(<span class="string">&quot;Event listeners&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// register a new HTTP handler</span></span><br><span class="line">        http.registerHttpHandler(<span class="keyword">new</span> <span class="title class_">MyHttpHandler</span>(api));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// register new Proxy handlers</span></span><br><span class="line">        proxy.registerRequestHandler(<span class="keyword">new</span> <span class="title class_">MyProxyRequestHandler</span>(api));</span><br><span class="line">        proxy.registerResponseHandler(<span class="keyword">new</span> <span class="title class_">MyProxyResponseHandler</span>(api));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// register a new Audit Issue handler</span></span><br><span class="line">        scanner.registerAuditIssueHandler(<span class="keyword">new</span> <span class="title class_">MyAuditIssueListenerHandler</span>());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// register a new extension unload handler</span></span><br><span class="line">        extension.registerUnloadingHandler(<span class="keyword">new</span> <span class="title class_">MyExtensionUnloadHandler</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">MyAuditIssueListenerHandler</span> <span class="keyword">implements</span> <span class="title class_">AuditIssueHandler</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleNewAuditIssue</span><span class="params">(AuditIssue auditIssue)</span> &#123;</span><br><span class="line">            logging.logToOutput(<span class="string">&quot;New scan issue: &quot;</span> + auditIssue.name());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">MyExtensionUnloadHandler</span> <span class="keyword">implements</span> <span class="title class_">ExtensionUnloadingHandler</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">extensionUnloaded</span><span class="params">()</span> &#123;</span><br><span class="line">            logging.logToOutput(<span class="string">&quot;Extension was unloaded.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyHttpHandler</span> <span class="keyword">implements</span> <span class="title class_">HttpHandler</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Logging logging;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyHttpHandler</span><span class="params">(MontoyaApi api)</span></span><br><span class="line">    &#123;</span><br><span class="line">        logging = api.logging();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> RequestToBeSentAction <span class="title function_">handleHttpRequestToBeSent</span><span class="params">(HttpRequestToBeSent httpRequestToBeSent)</span> &#123;</span><br><span class="line">        logging.logToOutput(<span class="string">&quot;HTTP request to &quot;</span> + httpRequestToBeSent.httpService() + <span class="string">&quot; [&quot;</span> + httpRequestToBeSent.toolSource().toolType().toolName() + <span class="string">&quot;]&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> RequestToBeSentAction.continueWith(httpRequestToBeSent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ResponseReceivedAction <span class="title function_">handleHttpResponseReceived</span><span class="params">(HttpResponseReceived httpResponseReceived)</span> &#123;</span><br><span class="line">        logging.logToOutput(<span class="string">&quot;HTTP response from &quot;</span> + httpResponseReceived.initiatingRequest().httpService() + <span class="string">&quot; [&quot;</span> + httpResponseReceived.toolSource().toolType().toolName() + <span class="string">&quot;]&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ResponseReceivedAction.continueWith(httpResponseReceived);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyProxyRequestHandler</span> <span class="keyword">implements</span> <span class="title class_">ProxyRequestHandler</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Logging logging;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyProxyRequestHandler</span><span class="params">(MontoyaApi api)</span></span><br><span class="line">    &#123;</span><br><span class="line">        logging = api.logging();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ProxyRequestReceivedAction <span class="title function_">handleRequestReceived</span><span class="params">(InterceptedRequest interceptedRequest)</span> &#123;</span><br><span class="line">        logging.logToOutput(<span class="string">&quot;Initial intercepted proxy request to &quot;</span> + interceptedRequest.httpService());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ProxyRequestReceivedAction.continueWith(interceptedRequest);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ProxyRequestToBeSentAction <span class="title function_">handleRequestToBeSent</span><span class="params">(InterceptedRequest interceptedRequest)</span> &#123;</span><br><span class="line">        logging.logToOutput(<span class="string">&quot;Final intercepted proxy request to &quot;</span> + interceptedRequest.httpService());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ProxyRequestToBeSentAction.continueWith(interceptedRequest);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyProxyResponseHandler</span> <span class="keyword">implements</span> <span class="title class_">ProxyResponseHandler</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Logging logging;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyProxyResponseHandler</span><span class="params">(MontoyaApi api)</span></span><br><span class="line">    &#123;</span><br><span class="line">        logging = api.logging();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ProxyResponseReceivedAction <span class="title function_">handleResponseReceived</span><span class="params">(InterceptedResponse interceptedResponse)</span> &#123;</span><br><span class="line">        logging.logToOutput(<span class="string">&quot;Initial intercepted proxy response from &quot;</span> + interceptedResponse.initiatingRequest().httpService());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ProxyResponseReceivedAction.continueWith(interceptedResponse);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ProxyResponseToBeSentAction <span class="title function_">handleResponseToBeSent</span><span class="params">(InterceptedResponse interceptedResponse)</span> &#123;</span><br><span class="line">        logging.logToOutput(<span class="string">&quot;Final intercepted proxy response from &quot;</span> + interceptedResponse.initiatingRequest().httpService());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ProxyResponseToBeSentAction.continueWith(interceptedResponse);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/10/23/tools/burpsuite-plugins/image-2.png" alt="原来上面的输出out是指记录在这里导入插件之后的out"><br><img src="/2024/10/23/tools/burpsuite-plugins/image-3.png" alt="在插件页面这里也可以看到"></p>
<h2 id="Traffic-Redirector-Example-Extension"><a href="#Traffic-Redirector-Example-Extension" class="headerlink" title="Traffic Redirector Example Extension"></a>Traffic Redirector Example Extension</h2><p>This extension demonstrates how to redirect outgoing HTTP requests from one host to another. This task might arise, for example, if you have mapped out an application which then moves to a different staging URL. By simply redirecting traffic to the new hostname, you can continue to drive your testing from the original site map.</p>
<p>The extension works as follows:</p>
<ul>
<li>It registers an HTTP handler.</li>
<li>For outgoing request messages, it retrieves the HTTP service for the request.</li>
<li>If the HTTP service host matches the “from” host, builds an HTTP service using the “to” host, and other details unchanged.</li>
<li>It returns the HTTP request with the new HTTP service.</li>
</ul>
<p><strong>Note:</strong> The sample code uses “host1.example.org” and “host2.example.org” as the “from” and “to” hostnames. You should edit the code to use your own hostnames before using it.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TrafficRedirector</span> <span class="keyword">implements</span> <span class="title class_">BurpExtension</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">HOST_FROM</span> <span class="operator">=</span> <span class="string">&quot;host1.example.org&quot;</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">HOST_TO</span> <span class="operator">=</span> <span class="string">&quot;host2.example.org&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(MontoyaApi api)</span> &#123;</span><br><span class="line">        <span class="comment">// set extension name</span></span><br><span class="line">        api.extension().setName(<span class="string">&quot;Traffic redirector&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// register a new HTTP handler</span></span><br><span class="line">        api.http().registerHttpHandler(<span class="keyword">new</span> <span class="title class_">MyHttpHandler</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.HttpService;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.handler.*;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.requests.HttpRequest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.http.HttpService.httpService;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.http.handler.RequestToBeSentAction.continueWith;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyHttpHandler</span> <span class="keyword">implements</span> <span class="title class_">HttpHandler</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> RequestToBeSentAction <span class="title function_">handleHttpRequestToBeSent</span><span class="params">(HttpRequestToBeSent httpRequestToBeSent)</span> &#123;</span><br><span class="line">        <span class="type">HttpService</span> <span class="variable">service</span> <span class="operator">=</span> httpRequestToBeSent.httpService();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (TrafficRedirector.HOST_FROM.equalsIgnoreCase(service.host())) &#123;</span><br><span class="line">            <span class="type">HttpRequest</span> <span class="variable">updatedHttpServiceRequest</span> <span class="operator">=</span> httpRequestToBeSent.withService(httpService(TrafficRedirector.HOST_TO, service.port(), service.secure()));</span><br><span class="line">            <span class="type">HttpRequest</span> <span class="variable">updatedHostHeaderRequest</span> <span class="operator">=</span> updatedHttpServiceRequest.withUpdatedHeader(<span class="string">&quot;Host&quot;</span>, TrafficRedirector.HOST_TO);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> continueWith(updatedHostHeaderRequest);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> continueWith(httpRequestToBeSent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ResponseReceivedAction <span class="title function_">handleHttpResponseReceived</span><span class="params">(HttpResponseReceived httpResponseReceived)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ResponseReceivedAction.continueWith(httpResponseReceived);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Custom-Logger-Example-Extension"><a href="#Custom-Logger-Example-Extension" class="headerlink" title="Custom Logger Example Extension"></a>Custom Logger Example Extension</h2><p>Adds a new tab to Burp’s UI and displays a log of HTTP traffic for all Burp tools.</p>
<hr>
<p>This extension provides a suite-wide HTTP logger within the main Burp UI.</p>
<p>The extension uses the following techniques:</p>
<ul>
<li>It creates a custom tab within the main Burp UI, in which to display logging user interface</li>
<li>It displays a table of items and a read-only editor for requests and responses within a splitpane</li>
<li>When an item passes through the HttpHandler, it gets added to the table</li>
<li>You can view the request and response for an item in the table by clicking on the relevant row</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入所需的类和接口</span></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.BurpExtension;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.handler.HttpResponseReceived;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.ui.UserInterface;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.ui.editor.HttpRequestEditor;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.ui.editor.HttpResponseEditor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使编辑器为只读</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.ui.editor.EditorOptions.READ_ONLY;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现 BurpExtension 接口的 CustomLogger 类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomLogger</span> <span class="keyword">implements</span> <span class="title class_">BurpExtension</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> MontoyaApi api;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(MontoyaApi api)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.api = api;  <span class="comment">// 存储 MontoyaApi 实例</span></span><br><span class="line">        api.extension().setName(<span class="string">&quot;Custom logger&quot;</span>);  <span class="comment">// 设置插件的名称</span></span><br><span class="line"></span><br><span class="line">        <span class="type">MyTableModel</span> <span class="variable">tableModel</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyTableModel</span>();  <span class="comment">// 创建表格模型实例</span></span><br><span class="line">        api.userInterface().registerSuiteTab(<span class="string">&quot;Custom logger&quot;</span>, constructLoggerTab(tableModel));  <span class="comment">// 注册插件UI到Burp的标签页</span></span><br><span class="line">        api.http().registerHttpHandler(<span class="keyword">new</span> <span class="title class_">MyHttpHandler</span>(tableModel));  <span class="comment">// 注册HTTP处理器来记录响应</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构建日志标签页的方法，接受一个 MyTableModel 对象作为参数</span></span><br><span class="line">    <span class="keyword">private</span> Component <span class="title function_">constructLoggerTab</span><span class="params">(MyTableModel tableModel)</span> &#123;</span><br><span class="line">        <span class="type">JSplitPane</span> <span class="variable">splitPane</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSplitPane</span>(JSplitPane.VERTICAL_SPLIT);  <span class="comment">// 创建垂直分割面板</span></span><br><span class="line"></span><br><span class="line">        <span class="type">JTabbedPane</span> <span class="variable">tabs</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JTabbedPane</span>();  <span class="comment">// 创建标签页容器</span></span><br><span class="line"></span><br><span class="line">        <span class="type">UserInterface</span> <span class="variable">userInterface</span> <span class="operator">=</span> api.userInterface();</span><br><span class="line">        <span class="type">HttpRequestEditor</span> <span class="variable">requestViewer</span> <span class="operator">=</span> userInterface.createHttpRequestEditor(READ_ONLY);  <span class="comment">// 创建请求编辑器，设置为只读</span></span><br><span class="line">        <span class="type">HttpResponseEditor</span> <span class="variable">responseViewer</span> <span class="operator">=</span> userInterface.createHttpResponseEditor(READ_ONLY);  <span class="comment">// 创建响应编辑器，同样设置为只读</span></span><br><span class="line"></span><br><span class="line">        tabs.addTab(<span class="string">&quot;Request&quot;</span>, requestViewer.uiComponent());  <span class="comment">// 添加请求编辑器到标签页</span></span><br><span class="line">        tabs.addTab(<span class="string">&quot;Response&quot;</span>, responseViewer.uiComponent());  <span class="comment">// 添加响应编辑器到标签页</span></span><br><span class="line"></span><br><span class="line">        splitPane.setRightComponent(tabs);  <span class="comment">// 设置分割面板的右侧组件为标签页</span></span><br><span class="line"></span><br><span class="line">        <span class="type">JTable</span> <span class="variable">table</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JTable</span>(tableModel) &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">changeSelection</span><span class="params">(<span class="type">int</span> rowIndex, <span class="type">int</span> columnIndex, <span class="type">boolean</span> toggle, <span class="type">boolean</span> extend)</span> &#123;</span><br><span class="line">                <span class="comment">// 选择表格行时显示相应的HTTP请求和响应</span></span><br><span class="line">                <span class="type">HttpResponseReceived</span> <span class="variable">responseReceived</span> <span class="operator">=</span> tableModel.get(rowIndex);</span><br><span class="line">                requestViewer.setRequest(responseReceived.initiatingRequest());</span><br><span class="line">                responseViewer.setResponse(responseReceived);</span><br><span class="line"></span><br><span class="line">                <span class="built_in">super</span>.changeSelection(rowIndex, columnIndex, toggle, extend);  <span class="comment">// 调用父类方法处理选择逻辑</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">JScrollPane</span> <span class="variable">scrollPane</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JScrollPane</span>(table);  <span class="comment">// 将表格放在滚动窗格中</span></span><br><span class="line"></span><br><span class="line">        splitPane.setLeftComponent(scrollPane);  <span class="comment">// 设置分割面板的左侧组件为滚动窗格</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> splitPane;  <span class="comment">// 返回构建好的组件</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.handler.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现 HttpHandler 接口的 MyHttpHandler 类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyHttpHandler</span> <span class="keyword">implements</span> <span class="title class_">HttpHandler</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MyTableModel tableModel; <span class="comment">// 私有最终成员变量，用于存储引用到 MyTableModel 对象</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造函数，接收一个 MyTableModel 实例</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyHttpHandler</span><span class="params">(MyTableModel tableModel)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.tableModel = tableModel; <span class="comment">// 存储传入的 MyTableModel 对象</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理即将发送的 HTTP 请求的方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> RequestToBeSentAction <span class="title function_">handleHttpRequestToBeSent</span><span class="params">(HttpRequestToBeSent requestToBeSent)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 这个方法目前仅将请求继续传递出去，没有进行修改或其他处理</span></span><br><span class="line">        <span class="keyword">return</span> RequestToBeSentAction.continueWith(requestToBeSent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理接收到的 HTTP 响应的方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ResponseReceivedAction <span class="title function_">handleHttpResponseReceived</span><span class="params">(HttpResponseReceived responseReceived)</span></span><br><span class="line">    &#123;</span><br><span class="line">        tableModel.add(responseReceived); <span class="comment">// 将接收到的响应添加到表格模型中，用于日志记录</span></span><br><span class="line">        <span class="comment">// 这个方法也将响应继续传递出去，确保其他可能的处理器或 Burp 本身可以进一步处理响应</span></span><br><span class="line">        <span class="keyword">return</span> ResponseReceivedAction.continueWith(responseReceived);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.handler.HttpResponseReceived;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.table.AbstractTableModel;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 继承自 AbstractTableModel 的 MyTableModel 类，用于管理和显示 HTTP 响应数据</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTableModel</span> <span class="keyword">extends</span> <span class="title class_">AbstractTableModel</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> List&lt;HttpResponseReceived&gt; log; <span class="comment">// 私有最终列表，用于存储 HttpResponseReceived 对象</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造函数，初始化 log 列表</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyTableModel</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.log = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取表格的行数，等于 log 列表的大小</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">int</span> <span class="title function_">getRowCount</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> log.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取表格的列数，这里固定为 2 列</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getColumnCount</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据列索引获取列名</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getColumnName</span><span class="params">(<span class="type">int</span> column)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">switch</span> (column)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">0</span> -&gt; <span class="string">&quot;Tool&quot;</span>; <span class="comment">// 第一列显示使用的工具</span></span><br><span class="line">                    <span class="keyword">case</span> <span class="number">1</span> -&gt; <span class="string">&quot;URL&quot;</span>;  <span class="comment">// 第二列显示请求的 URL</span></span><br><span class="line">                    <span class="keyword">default</span> -&gt; <span class="string">&quot;&quot;</span>;</span><br><span class="line">                &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取指定单元格的值，用于表格显示</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> Object <span class="title function_">getValueAt</span><span class="params">(<span class="type">int</span> rowIndex, <span class="type">int</span> columnIndex)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">HttpResponseReceived</span> <span class="variable">responseReceived</span> <span class="operator">=</span> log.get(rowIndex);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">switch</span> (columnIndex)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">0</span> -&gt; responseReceived.toolSource().toolType(); <span class="comment">// 第一列显示工具类型</span></span><br><span class="line">                    <span class="keyword">case</span> <span class="number">1</span> -&gt; responseReceived.initiatingRequest().url(); <span class="comment">// 第二列显示请求 URL</span></span><br><span class="line">                    <span class="keyword">default</span> -&gt; <span class="string">&quot;&quot;</span>;</span><br><span class="line">                &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加一个新的 HttpResponseReceived 对象到 log 列表，并通知表格有新行插入</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(HttpResponseReceived responseReceived)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> log.size();</span><br><span class="line">        log.add(responseReceived);</span><br><span class="line">        fireTableRowsInserted(index, index); <span class="comment">// 触发表格更新事件</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据行索引获取 HttpResponseReceived 对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> HttpResponseReceived <span class="title function_">get</span><span class="params">(<span class="type">int</span> rowIndex)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> log.get(rowIndex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/10/23/tools/burpsuite-plugins/image-4.png" alt="上面创建的面板界面如图所示"></p>
<h2 id="Custom-Request-Editor-Tab-Example-Extension"><a href="#Custom-Request-Editor-Tab-Example-Extension" class="headerlink" title="Custom Request Editor Tab Example Extension"></a>Custom Request Editor Tab Example Extension</h2><p>Adds a new tab to Burp’s HTTP message editor, in order to handle a data serialization format</p>
<hr>
<p>This extension provides a new tab on the message editor for requests that contain a specified parameter.</p>
<p>The extension uses the following techniques:</p>
<ul>
<li>It creates a custom request tab on the message editor, provided that the <code>data</code> parameter is present</li>
<li>If it is appropriate, the editor is set to be read-only</li>
<li>The value of the <code>data</code> parameter is deserialized (URL decoded, then Base64 decoded) and displayed in the custom tab</li>
<li>If the value of the data is modified, the content will be re-serialized (Base64 encoded then URL encoded) and updated in the HttpRequest</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.ui.editor.extension.EditorCreationContext;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.ui.editor.extension.ExtensionProvidedHttpRequestEditor;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.ui.editor.extension.HttpRequestEditorProvider;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现 HttpRequestEditorProvider 接口的 MyHttpRequestEditorProvider 类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyHttpRequestEditorProvider</span> <span class="keyword">implements</span> <span class="title class_">HttpRequestEditorProvider</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MontoyaApi api; <span class="comment">// 私有最终字段，用于存储 MontoyaApi 实例</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造函数，接收一个 MontoyaApi 实例</span></span><br><span class="line">    MyHttpRequestEditorProvider(MontoyaApi api)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.api = api;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 提供自定义的 HTTP 请求编辑器的方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ExtensionProvidedHttpRequestEditor <span class="title function_">provideHttpRequestEditor</span><span class="params">(EditorCreationContext creationContext)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 返回一个新创建的 MyExtensionProvidedHttpRequestEditor 实例</span></span><br><span class="line">        <span class="comment">// 传递 MontoyaApi 实例和编辑器创建上下文</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyExtensionProvidedHttpRequestEditor</span>(api, creationContext);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.core.ByteArray;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.HttpRequestResponse;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.params.HttpParameter;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.params.ParsedHttpParameter;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.requests.HttpRequest;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.ui.Selection;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.ui.editor.EditorOptions;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.ui.editor.RawEditor;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.ui.editor.extension.EditorCreationContext;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.ui.editor.extension.EditorMode;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.ui.editor.extension.ExtensionProvidedHttpRequestEditor;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.utilities.Base64EncodingOptions;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.utilities.Base64Utils;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.utilities.URLUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Optional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.core.ByteArray.byteArray;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义 HTTP 请求编辑器实现</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyExtensionProvidedHttpRequestEditor</span> <span class="keyword">implements</span> <span class="title class_">ExtensionProvidedHttpRequestEditor</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> RawEditor requestEditor;  <span class="comment">// 原始编辑器接口</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Base64Utils base64Utils;  <span class="comment">// Base64工具类</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> URLUtils urlUtils;  <span class="comment">// URL工具类</span></span><br><span class="line">    <span class="keyword">private</span> HttpRequestResponse requestResponse;  <span class="comment">// 当前的请求响应对象</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MontoyaApi api;  <span class="comment">// Montoya API 接口</span></span><br><span class="line">    <span class="keyword">private</span> ParsedHttpParameter parsedHttpParameter;  <span class="comment">// 解析的HTTP参数</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造函数</span></span><br><span class="line">    MyExtensionProvidedHttpRequestEditor(MontoyaApi api, EditorCreationContext creationContext)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.api = api;</span><br><span class="line">        base64Utils = api.utilities().base64Utils();</span><br><span class="line">        urlUtils = api.utilities().urlUtils();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 根据编辑模式创建编辑器</span></span><br><span class="line">        <span class="keyword">if</span> (creationContext.editorMode() == EditorMode.READ_ONLY)</span><br><span class="line">        &#123;</span><br><span class="line">            requestEditor = api.userInterface().createRawEditor(EditorOptions.READ_ONLY);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            requestEditor = api.userInterface().createRawEditor();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取编辑后的请求</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> HttpRequest <span class="title function_">getRequest</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        HttpRequest request;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (requestEditor.isModified())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 如果编辑器被修改，重新序列化数据</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">base64Encoded</span> <span class="operator">=</span> base64Utils.encodeToString(requestEditor.getContents(), Base64EncodingOptions.URL);</span><br><span class="line">            <span class="type">String</span> <span class="variable">encodedData</span> <span class="operator">=</span> urlUtils.encode(base64Encoded);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 更新请求参数</span></span><br><span class="line">            request = requestResponse.request().withUpdatedParameters(HttpParameter.parameter(parsedHttpParameter.name(), encodedData, parsedHttpParameter.type()));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            request = requestResponse.request();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> request;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置请求响应对象</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRequestResponse</span><span class="params">(HttpRequestResponse requestResponse)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.requestResponse = requestResponse;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 解码参数值</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">urlDecoded</span> <span class="operator">=</span> urlUtils.decode(parsedHttpParameter.value());</span><br><span class="line">        ByteArray output;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            output = base64Utils.decode(urlDecoded);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception e)</span><br><span class="line">        &#123;</span><br><span class="line">            output = byteArray(urlDecoded);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置编辑器内容</span></span><br><span class="line">        <span class="built_in">this</span>.requestEditor.setContents(output);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 确定编辑器是否适用于给定的请求响应</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEnabledFor</span><span class="params">(HttpRequestResponse requestResponse)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Optional&lt;ParsedHttpParameter&gt; dataParam = requestResponse.request().parameters().stream()</span><br><span class="line">            .filter(p -&gt; p.name().equals(<span class="string">&quot;data&quot;</span>)).findFirst();</span><br><span class="line"></span><br><span class="line">        dataParam.ifPresent(httpParameter -&gt; parsedHttpParameter = httpParameter);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> dataParam.isPresent();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 编辑器的标题</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">caption</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Serialized input&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取UI组件</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Component <span class="title function_">uiComponent</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> requestEditor.uiComponent();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取选中的数据</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Selection <span class="title function_">selectedData</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> requestEditor.selection().isPresent() ? requestEditor.selection().get() : <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断编辑器内容是否被修改</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isModified</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> requestEditor.isModified();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.BurpExtension;  <span class="comment">// 引入 BurpExtension 接口</span></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;  <span class="comment">// 引入 MontoyaApi，用于访问 Burp Suite API</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现 BurpExtension 接口的 CustomRequestEditorTab 类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomRequestEditorTab</span> <span class="keyword">implements</span> <span class="title class_">BurpExtension</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(MontoyaApi api)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 设置插件的名称</span></span><br><span class="line">        api.extension().setName(<span class="string">&quot;Serialized input editor&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 在 Burp 用户界面中注册自定义的 HTTP 请求编辑器提供者</span></span><br><span class="line">        <span class="comment">// MyHttpRequestEditorProvider 是一个自定义类，负责提供编辑器的具体实现</span></span><br><span class="line">        api.userInterface().registerHttpRequestEditorProvider(<span class="keyword">new</span> <span class="title class_">MyHttpRequestEditorProvider</span>(api));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的代码为含有参数data的请求新建了特殊的编辑器，可以对data参数进行配置修改<br><img src="/2024/10/23/tools/burpsuite-plugins/image-5.png"></p>
<h2 id="Custom-Scan-Checks-Example-Extension"><a href="#Custom-Scan-Checks-Example-Extension" class="headerlink" title="Custom Scan Checks Example Extension"></a>Custom Scan Checks Example Extension</h2><p>The sample extension demonstrates the following techniques:</p>
<ul>
<li>Registering a custom <code>AuditInsertionPointProvider</code></li>
<li>If the request contains the <code>data</code> parameter, it will provide a custom <code>AuditInsertionPoint</code></li>
<li>The custom <code>AuditInsertionPoint</code> will perform the following:<ul>
<li>Deserialize the data (URL decode and then Base64 decode)</li>
<li>Parse the location of the <code>input=</code> string withing the decoded data</li>
<li>Split the data into a prefix, location to place the payload, and a suffix</li>
<li>When building the request with the appropriate payload, it will perform the following:<ul>
<li>Build the raw data with the appropriate payload</li>
<li>Re-serialize the data (Base64 encode then URL encode)</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;  <span class="comment">// 引入 MontoyaApi，用于访问 Burp Suite 的 API</span></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.HttpRequestResponse;  <span class="comment">// 引入用于处理 HTTP 请求响应的类</span></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.params.ParsedHttpParameter;  <span class="comment">// 引入用于解析 HTTP 参数的类</span></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.scanner.audit.insertionpoint.AuditInsertionPoint;  <span class="comment">// 引入审核插入点接口</span></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.scanner.audit.insertionpoint.AuditInsertionPointProvider;  <span class="comment">// 引入审核插入点提供者接口</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;  <span class="comment">// 引入 Java 的 List 接口</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.util.stream.Collectors.toList;  <span class="comment">// 引入用于收集 Stream 结果的工具方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现 AuditInsertionPointProvider 接口的 MyInsertionPointProvider 类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyInsertionPointProvider</span> <span class="keyword">implements</span> <span class="title class_">AuditInsertionPointProvider</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> MontoyaApi api;  <span class="comment">// 保存 MontoyaApi 实例的私有最终字段</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造函数，接收一个 MontoyaApi 实例</span></span><br><span class="line">    MyInsertionPointProvider(MontoyaApi api)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.api = api;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 重写提供插入点的方法</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;AuditInsertionPoint&gt; <span class="title function_">provideInsertionPoints</span><span class="params">(HttpRequestResponse baseHttpRequestResponse)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 从请求中获取所有参数</span></span><br><span class="line">        List&lt;ParsedHttpParameter&gt; parameters = baseHttpRequestResponse.request().parameters();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 过滤出名为 &quot;data&quot; 的参数，并为每个这样的参数创建一个新的审核插入点</span></span><br><span class="line">        <span class="keyword">return</span> parameters.stream()</span><br><span class="line">                .filter(p -&gt; p.name().equals(<span class="string">&quot;data&quot;</span>))  <span class="comment">// 过滤出参数名为 &quot;data&quot; 的参数</span></span><br><span class="line">                .map(p -&gt; <span class="keyword">new</span> <span class="title class_">MyAuditInsertionPoint</span>(api, baseHttpRequestResponse, p))  <span class="comment">// 为每个符合条件的参数创建一个 MyAuditInsertionPoint 实例</span></span><br><span class="line">                .collect(toList());  <span class="comment">// 收集结果到 List 中</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.core.ByteArray;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.core.Range;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.HttpRequestResponse;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.params.HttpParameter;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.params.ParsedHttpParameter;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.http.message.requests.HttpRequest;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.scanner.audit.insertionpoint.AuditInsertionPoint;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.utilities.Utilities;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> burp.api.montoya.http.message.params.HttpParameter.parameter;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现 AuditInsertionPoint 接口的 MyAuditInsertionPoint 类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyAuditInsertionPoint</span> <span class="keyword">implements</span> <span class="title class_">AuditInsertionPoint</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String insertionPointPrefix;  <span class="comment">// 插入点之前的文本</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String insertionPointSuffix;  <span class="comment">// 插入点之后的文本</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> HttpRequestResponse requestResponse;  <span class="comment">// 请求响应对象</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ParsedHttpParameter parameter;  <span class="comment">// 被操作的 HTTP 参数</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String baseValue;  <span class="comment">// 参数值的基本形式</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Utilities utilities;  <span class="comment">// Utilities 对象，提供编解码等功能</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造函数，初始化参数和实用工具</span></span><br><span class="line">    MyAuditInsertionPoint(MontoyaApi api, HttpRequestResponse baseHttpRequestResponse, ParsedHttpParameter parameter)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.requestResponse = baseHttpRequestResponse;</span><br><span class="line">        <span class="built_in">this</span>.parameter = parameter;</span><br><span class="line">        <span class="built_in">this</span>.utilities = api.utilities();</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">paramValue</span> <span class="operator">=</span> parameter.value();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// URL 和 base-64 解码数据</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">urlDecoded</span> <span class="operator">=</span> utilities.urlUtils().decode(paramValue);</span><br><span class="line">        <span class="type">ByteArray</span> <span class="variable">byteData</span> <span class="operator">=</span> utilities.base64Utils().decode(urlDecoded);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> byteData.toString();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 解析输入字符串在解码数据中的位置</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> data.indexOf(<span class="string">&quot;input=&quot;</span>) + <span class="number">6</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">end</span> <span class="operator">=</span> data.indexOf(<span class="string">&quot;&amp;&quot;</span>, start);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (end == -<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            end = data.length();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        baseValue = data.substring(start, end);</span><br><span class="line"></span><br><span class="line">        insertionPointPrefix = data.substring(<span class="number">0</span>, start);</span><br><span class="line">        insertionPointSuffix = data.substring(end);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回插入点的名称</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">name</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Base64-wrapped input&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回原始值</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">baseValue</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> baseValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用特定的 payload 构建带有负载的 HTTP 请求</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> HttpRequest <span class="title function_">buildHttpRequestWithPayload</span><span class="params">(ByteArray payload)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 构建原始数据使用指定的负载</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">input</span> <span class="operator">=</span> insertionPointPrefix + payload.toString() + insertionPointSuffix;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Base-64 和 URL 编码数据</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">updatedParameterValue</span> <span class="operator">=</span> utilities.urlUtils().encode(utilities.base64Utils().encodeToString(input));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 更新 HTTP 参数</span></span><br><span class="line">        <span class="type">HttpParameter</span> <span class="variable">updatedParameter</span> <span class="operator">=</span> parameter(parameter.name(), updatedParameterValue, parameter.type());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 返回更新参数的 HTTP 请求</span></span><br><span class="line">        <span class="keyword">return</span> requestResponse.request().withUpdatedParameters(updatedParameter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回问题高亮区域的方法，此处未实现</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Range&gt; <span class="title function_">issueHighlights</span><span class="params">(ByteArray payload)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.BurpExtension;</span><br><span class="line"><span class="keyword">import</span> burp.api.montoya.MontoyaApi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomScanInsertionPoints</span> <span class="keyword">implements</span> <span class="title class_">BurpExtension</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(MontoyaApi api)</span></span><br><span class="line">    &#123;</span><br><span class="line">        api.extension().setName(<span class="string">&quot;Custom scan insertion points&quot;</span>);</span><br><span class="line"></span><br><span class="line">        api.scanner().registerInsertionPointProvider(<span class="keyword">new</span> <span class="title class_">MyInsertionPointProvider</span>(api));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面这个示例不是很懂，也没找到对应的出发点</p>

  </div>
</article>


    <div class="blog-post-comments">
        <div id="utterances_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/categories/">Categories</a></li>
        
          <li><a href="/idea/">Idea</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/g0dam">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Hello-World"><span class="toc-number">1.</span> <span class="toc-text">Hello World</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP-Handler-Example-Extension"><span class="toc-number">2.</span> <span class="toc-text">HTTP Handler Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Proxy-Handler-Example-Extension"><span class="toc-number">3.</span> <span class="toc-text">Proxy Handler Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Event-Listeners-Example-Extension"><span class="toc-number">4.</span> <span class="toc-text">Event Listeners Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Traffic-Redirector-Example-Extension"><span class="toc-number">5.</span> <span class="toc-text">Traffic Redirector Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Custom-Logger-Example-Extension"><span class="toc-number">6.</span> <span class="toc-text">Custom Logger Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Custom-Request-Editor-Tab-Example-Extension"><span class="toc-number">7.</span> <span class="toc-text">Custom Request Editor Tab Example Extension</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Custom-Scan-Checks-Example-Extension"><span class="toc-number">8.</span> <span class="toc-text">Custom Scan Checks Example Extension</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&text=【工具开发】Burpsuite 插件开发"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&title=【工具开发】Burpsuite 插件开发"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&is_video=false&description=【工具开发】Burpsuite 插件开发"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=【工具开发】Burpsuite 插件开发&body=Check out this article: https://godreams.cn/2024/10/23/tools/burpsuite-plugins/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&title=【工具开发】Burpsuite 插件开发"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&title=【工具开发】Burpsuite 插件开发"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&title=【工具开发】Burpsuite 插件开发"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&title=【工具开发】Burpsuite 插件开发"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&name=【工具开发】Burpsuite 插件开发&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://godreams.cn/2024/10/23/tools/burpsuite-plugins/&t=【工具开发】Burpsuite 插件开发"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2024-2025
    g0dam
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/categories/">Categories</a></li><!--
     --><!--
       --><li><a href="/idea/">Idea</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/g0dam">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

    <script type="text/javascript">
      var utterances_repo = 'owner/githubrepo';
      var utterances_issue_term = 'pathname';
      var utterances_label = 'Comment';
      var utterances_theme = 'github-dark';

      (function(){
          var script = document.createElement('script');

          script.src = 'https://utteranc.es/client.js';
          script.setAttribute('repo', utterances_repo);
          script.setAttribute('issue-term', 'pathname');
          script.setAttribute('label', utterances_label);
          script.setAttribute('theme', utterances_theme);
          script.setAttribute('crossorigin', 'anonymous');
          script.async = true;
          (document.getElementById('utterances_thread')).appendChild(script);
      }());
  </script>

</body>
</html>
